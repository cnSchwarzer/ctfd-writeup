# modernlevel4

## 题目给出了两个数n1 n2 以及产生方法，所以我们发现，n1 n2 的最大公约数就是p

##也就是说我们知道了关于 n1 n2 的所有数字关系，p q1 q2

## 所以我们可以求出来所有的d1 d2

## 下面是代码

```python
from gmpy2 import *

e = 65537
n1 = 486524706295089732041906539380663893076173072031376347315017509533053668622141205176101399697945591560727540480021114228187032069150862081839407806354211806325963581761470563208269830655236645093573116845226372711351584540407617259897344772683552306473554136172968554490617832352311919162056599713932617679604697289435659760041960920480242953928061473857605516859921936166517125743292210614714981542320037973898955230085256698223122718131325642885019895040679803065437668017064386270308807088183403243053613725640118047234340739335074368230205765781855624845658622329776079692401231568686592968097453283727383377602284468483182882026141238791132824095369454425841075549267748941530326308709957361872360365082764197961163673576474659784361747149052181242131358517136463298837326451344943887328594838775515461462099210044565124850202908023216078442258732775882148585821703018864234951702482426452393324232985116116245111898482216240076774673936972934087263050050118387726107895471355412076978464236340437992750613911405458309201296606088289958401477113524353667900203790549030826470705368788285036417859389582540782740342532708559776681032335320351347770602510353072990423617107012998496982134833184397760350179269362736294092061896367
n2 = 545654303560543179326309952070108014752427938011189461194420750039711946717666639119464707247871343747829573628260978623199075796645703227811777481223449682857593959058977963255155294001501538472075021405837542942982705000664540167913877107634048510591022436145162050697149947236323587820719637633996145039535554783435902487644896323160637966216855768185529241347212557611652852793173629510075180250289809944380852399119803145145575492099085177061411938004773652930737474110169133182361155595222153273704028277942166561903055221479555436892413256435518791161241157530552492540896156792120639969241650232928772254530526167947164885582044727630979568597200047229049649590192023819045295810004686009477158954381843490341363191289447468800799498176929234079946026089745134100513865760914263735271839622023701386106096909682532356156621238621260427982123383328701122669900357388947546164375303190304751076327165758887261301248731193428913707198209766876451402130958883248365593977092977666783086565807792859457186235852293420384482973313605719624697685598364179295079559555520335368061115414246656605514974316888487266726670763591689573822008068522126363097667132252609963230462945557974900955434697304263240022421398730488289861373243303
ct = 506559301689398794697541556107477421507009159036784337866810641999470074547536249246564828319990508277874433398390172208122762737247616508459645005344911842776501546746038764473203882561025038034278543277335936772544882649848439737392162603370728515969164775028585402894562005791440584659228223390389162777325346432672530273191141837336013906829831852788910856351891618317245677080455370264457251607065849756609369408833265425106127704894413775705868795737780158771375137779299259787647393554616620840740771770520596409410975979108371130276862843985982489259309964251732077357803889088809210599423712955136241721327704569836498957517125001009931492470755297268258854493677543447790745175760470108572941148616976425151819760014829188154456323163636858636583094542984101616554121605372217258057048859694909033963300466732448114967219820159142452478586206839884050941110732925684447499140255571902373634009364417409305544047027314710090276529172135789433836548667635415445327543308678643914528180896657622438977564646954657053122451564286228234593669580372976181407484311420664237845259550566464835102422004786701403021413862002136115124870739010561958628106370366371104303621563779516919566883139871704724972535916640424958323428245907

p = gcd(n1,n2)

assert n1%p == 0
assert n2%p == 0

q1 = n1/p
q2 = n2/p

fn1 = (p-1)*(q1-1)
fn2 = (p-1)*(q2-1)

d2 = invert(e,fn2)
d1 = invert(e,fn1)

pt = pow(pow(ct,d2,n2),d1,n1)

print hex(pt)[2:].decode('hex')
```
##以及flag
## flag{unfortunately_this_two_keys_are_related}
