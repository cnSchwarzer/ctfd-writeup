# modernlevel5
## 介绍
如果在RSA的使用中使用了相同的模n对相同的明文m进行了加密，那么就可以在不分解n的情况下还原出明文m的值。即：

c1≡m^e1modn
c2≡m^e2modn
此时不需要分解n，不需要求解私钥，如果两个加密指数互素，就可以通过共模攻击在两个密文和公钥被嗅探到的情况下还原出明文m的值。

过程如下，首先两个加密指数互质，则：

(e1,e2)=1，即存在s2，使得：

s1*e1+s2*e2=1
∵c1≡m^e1 modn,c2≡m^e2 modn
代入化简可以得出：

c1^s1*c2^s2≡m modn
## 所以就是如下的代码了
```python
from gmpy2 import *

e1 = 65537
e2 = 988727

n = 504932278309564253608602650889930087454255769735359219231128004191687567104858742561515607674267955727791517332379015716300329804893367780191036660946218125577056805002201375693683536882441474550395798042394998349373163411928389472762233959317215180881422190670106746191837879731302764135019388713791734013407859716353180464199952632102710127836990174423575787898368295607679865452498918506060398576979345763088511738219259886670362357043461773410760820911943093562331281245996603952853660037710528246168902852845085979880417823031241876757408332219493869194793786413876280522538839735988167487457753034584972063402514427434181777804960064594019704941136759359011214602172326049608700686714918687468129769360254171616208823165012288559701626802655773548327231128574073678055386647976667143901301169546960918930520575459097948868320300838291126663877243202010390152026655156591636803622252608080804328063830188245150860976028480836017233380221120423422912551295836410624352130269821486331647489235731075753973784066543993208335878996264847016014438529650032366022841151653938365788265105675030000284208638677574632164925558830854574604243277031730320788524786552853785654621530752050588155010619154457103717069978808312414439923992601

ct1 = 122467160656119199410887376531211479629517882284304474978238661358952010289851019225677550769320788975887715928884430134986065803815037932741840288893091240859896703424723876921147553251978463951596056206060007650169568321174157547632951198840099273367421174727362921502019507833677977057644490860350085604042189159153124514411978282911148637400407826702320058413724577855451529352147091335076738141934128455216231344788226079084411012765988795539683076071127198252613223991004725583627196183628583104716728002719214168401746008924795634062468815653177723820083908218298675823674784857971781568020150747497232148180132869965692498185730720868768346161117128060318314342456870368968815372427631345612141415798154573773123264468075398701312867605979060295129299873221837267176745405972688421139519836702602621125756077404691526932790332872455710053726315527973306278494338847489210799391712742496204716922735908302015063347598831344701617526390258712746452069309652959893285822811354597260151713791184023013878121568140916916023539203655041272538322343588521520018617331468497116087772488281204658383835102707194827321498921142161352689912179476937386233246955141800428009676037300961370009177100508639226630932344930801148685797908515

ct2 = 167615190378762045962308419454527094689989754487035462909953637188227054588966201297866084103388329117673018578844006851042093185461700400337633509959692603413522952996884625485480024793732132560120729452835779110639709461345006156542615496303649635852971740460126886426463417683825370609163211654888232447219846137028813200227862704663880796616803694826160330457235161385042346650653934087302031364369932171799388106977779189032181027749928413652614408527493334568691303814535876893597553693771518104160367824733389692507802441339251001491097779391554725751620389486781228876156775308879595190536947617373465517518177229779229153898009405386600077264498067341873688960561613803727370596250611352448544277556520411263094463436009265680441469884375223230975193567832718224796679365107428754944445521842974994287894919926242188030153461147598880564355630075379447527237203778810301494154524662697599810363543732093585342006156828786103664174824012132139238545955308340769776378736857737593254165758064286394733104001077643680058679565408298401017927130755544345089426810984352819132128932660016902722566065890844087206234771915090379906355136343203190585082613707367065602210489927604741959952301178188377662067899822378404798450721263

s = gcdext(e1,e2)
print s
s1 = s[1]
s2 = s[2]
assert gcd(e1,e2)==1

if s1 < 0:
    s1 = -s1
    ct1 = invert(ct1,n)

elif s2 < 0:
    s2 = -s2
    ct2 = invert(ct2,n)

m = pow(ct1,s1,n)*pow(ct2,s2,n)%n

print hex(m)[2:].decode('hex')

```
## 于是我们有了flag
## flag{just_mathematical_issues_here}
